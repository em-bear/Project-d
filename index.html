<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=320, height=320, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Project-D Pi Display</title>

<style>
* { box-sizing: border-box; touch-action: none; margin:0; padding:0; }

body {
    background: #000;
    color: #fff;
    font-family: sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
}

/* SZÍNGOMBOK */
#topBar {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    padding: 4px;
    justify-content: center;
    background: #111;
    margin-bottom: 6px;
}

.color-btn {
    width: 24px;
    height: 24px;
    border: 2px solid #444;
    border-radius: 4px;
    cursor: pointer;
}

.color-btn.active {
    border-color: #fff;
}

/* GRID */
#grid {
    display: grid;
    grid-template-columns: repeat(32, 1fr);
    grid-template-rows: repeat(32, 1fr);
    width: 320px;
    height: 320px;
    border: 1px solid #333;
}

.cell {
    border: 0.2px solid #222;
    background: #000;
    width: 100%;
    height: 100%;
    cursor: pointer;
}

/* ALSÓ VEZÉRLŐ */
#controls {
    display: flex;
    justify-content: center;
    padding: 6px;
    background: #111;
    margin-top: 6px;
}

button {
    padding: 8px 16px;
    font-size: 14px;
    background: #333;
    color: white;
    border: 1px solid #666;
    cursor: pointer;
}
</style>
</head>

<body>

<div id="topBar"></div>

<div id="grid"></div>

<div id="controls">
    <button onclick="done()">DONE</button>
</div>

<script>
// SZÍNEK
const colors = [
    "red","green","blue","yellow","orange","purple",
    "pink","cyan","lime","brown","white","gray",
    "navy","teal","magenta"
];

let selectedColor = colors[0];
let drawingData = new Map();
let isTouching = false;

const topBar = document.getElementById("topBar");
const grid = document.getElementById("grid");

// Színpaletta
colors.forEach(c => {
    const btn = document.createElement("div");
    btn.className = "color-btn";
    btn.id = "color-" + c;
    btn.style.background = c;
    if (c === selectedColor) btn.classList.add("active");

    btn.onclick = () => {
        document.querySelectorAll(".color-btn").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        selectedColor = c;
    };

    topBar.appendChild(btn);
});

// GRID 32x32 cella
for (let y = 0; y < 32; y++) {
    for (let x = 0; x < 32; x++) {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.id = `cell-${y}-${x}`;

        const paint = () => {
            const key = `${x}-${y}`;
            if (drawingData.has(key)) {
                drawingData.delete(key);
                cell.style.background = "#000";
            } else {
                drawingData.set(key, selectedColor);
                cell.style.background = selectedColor;
            }
        };

        cell.onpointerdown = e => {
            isTouching = true;
            cell.releasePointerCapture(e.pointerId);
            paint();
        };

        cell.onpointerenter = () => {
            if (isTouching) paint();
        };

        grid.appendChild(cell);
    }
}

window.onpointerup = () => isTouching = false;

// DONE = letöltés
function done() {
    let out = "";
    drawingData.forEach((color, coord) => {
        out += `${coord} ${color}\n`;
    });

    const a = document.createElement("a");
    a.href = "data:text/plain;charset=utf-8," + encodeURIComponent(out);
    a.download = "coordinates.txt";
    a.click();
}
</script>

</body>
</html>