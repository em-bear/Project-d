<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=720, height=1280, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Project-D Display</title>

<style>
* { box-sizing: border-box; touch-action: none; }

body {
    margin: 0;
    background: #000;
    color: #fff;
    font-family: sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/* FIX kijelző méret */
#display {
    width: 720px;
    height: 1280px;
    background: black;
    display: flex;
    flex-direction: column;
}

/* Színpaletta */
#topBar {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    padding: 6px;
    justify-content: center;
    background: #111;
}

.color-btn {
    width: 40px;
    height: 40px;
    border: 2px solid #444;
    border-radius: 4px;
}

.color-btn.active {
    border-color: #fff;
}

/* GRID */
#grid {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(32, 1fr);
    grid-template-rows: repeat(32, 1fr);
}

/* CELL GOMB */
.cell {
    border: 0.2px solid #222;
    background: #000;
}

/* ALSÓ VEZÉRLŐ */
#controls {
    display: flex;
    justify-content: center;
    padding: 10px;
    background: #111;
}

button {
    padding: 12px 25px;
    font-size: 16px;
    background: #333;
    color: white;
    border: 1px solid #666;
}
</style>
</head>

<body>

<div id="display">

    <div id="topBar"></div>

    <div id="grid"></div>

    <div id="controls">
        <button onclick="done()">DONE</button>
    </div>

</div>

<script>
const colors = [
    "red","green","blue","yellow","orange","purple",
    "pink","cyan","lime","brown","white","gray",
    "navy","teal","magenta"
];

let selectedColor = colors[0];
let drawingData = new Map();
let isTouching = false;

const topBar = document.getElementById("topBar");
const grid = document.getElementById("grid");

/* SZÍNGOMBOK */
colors.forEach(c => {
    const btn = document.createElement("div");
    btn.className = "color-btn";
    btn.id = "color-" + c;
    btn.style.background = c;
    if (c === selectedColor) btn.classList.add("active");

    btn.onclick = () => {
        document.querySelectorAll(".color-btn").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        selectedColor = c;
    };

    topBar.appendChild(btn);
});

/* GRID GOMBOK 32x32 */
for (let y = 0; y < 32; y++) {
    for (let x = 0; x < 32; x++) {

        const cell = document.createElement("div");
        cell.className = "cell";
        cell.id = `cell-${y}-${x}`;

        const paint = () => {
            const key = `${x}-${y}`;
            if (drawingData.has(key)) {
                drawingData.delete(key);
                cell.style.background = "#000";
            } else {
                drawingData.set(key, selectedColor);
                cell.style.background = selectedColor;
            }
        };

        cell.onpointerdown = e => {
            isTouching = true;
            cell.releasePointerCapture(e.pointerId);
            paint();
        };

        cell.onpointerenter = () => {
            if (isTouching) paint();
        };

        grid.appendChild(cell);
    }
}

window.onpointerup = () => isTouching = false;

/* EXPORT */
function done() {
    let out = "";
    drawingData.forEach((color, coord) => {
        out += `${coord} ${color}\n`;
    });

    const a = document.createElement("a");
    a.href = "data:text/plain;charset=utf-8," + encodeURIComponent(out);
    a.download = "coordinates.txt";
    a.click();
}
</script>

</body>
</html>